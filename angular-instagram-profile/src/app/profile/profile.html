<!-- <section class=" "> -->
<div class="d-flex justify-content-between w-100">
  <!--!Message-->
  @if(messageVisible()){
  <p-message
    class="position-absolute"
    [life]="1500"
    [severity]="messageSeverity"
    [size]="'large'"
    >{{ message }}</p-message
  >}
  <p-button
    class="p-button-dialog position-absolute"
    (click)="visibleRegisterDialog = true"
    label="Sign up"
  />

  <!--! NAV -->
  <app-navbar (user)="onUserChange($event)"></app-navbar>
  <p-drawer> </p-drawer>
  <section class="w-100 d-flex justify-content-center">
    @if(user()){
    <div class="d-flex flex-column w-75 gap-5">
      <div class="div-profile-head d-flex align-items-center">
        <!--! Profile Pic -->
        <div class="div-profile-picture-container">
          <!-- <img
            [class.img-pfp--active]="true"
            class="img-pfp rounded-circle"
            src="{{ user().pfp_url || 'sunnyDay.jpg' }}"
            alt=""
          /> -->
          <p-avatar
            image="{{ user().pfp_url || 'sunnyDay.jpg' }}"
            class="mr-2"
            size="xlarge"
            shape="circle"
          />
        </div>
        <!--! Profile Details -->
        <div class="div-profile-details">
          <div class="d-flex w-100">
            <div class="div-profile-states d-flex flex-column gap-3 w-100">
              <!--! Username -->

              <h1 [@hover]="hovered ? 'mouseover' : 'mouseout'" class="span-username w-100">
                {{ user().username }}
                <!--! Edit icon  -->

                <!--! Delete icon  -->

                <span (click)="visibleEditDialog = true" class="pi pi-user-edit"></span>
                <span (click)="visibleDeleteDialog = true" class="pi pi-trash"></span>
              </h1>
              <!--! Account follow numbers  -->

              <span class="span-stats w-100 fs-5"
                >followers:<span>{{ user().followers || 0 }}</span> following:
                <span>{{ user().following || 0 }} </span> posts:
                <span>{{ user().posts?.length || '0' }}</span></span
              >
              <!--! Bio  -->
              <span class="fs-5">{{ user().bio }}</span>
            </div>
          </div>
          <!--! Action Buttons  -->
          <div class="div-action-button my-3">
            <p-button
              class=""
              size="large"
              label="Follow"
              [label]="follow() ? 'UnFollow' : 'Follow'"
              (onClick)="onFollowClick()"
              [icon]="follow() ? '' : 'pi pi-plus'"
              [severity]="follow() ? 'secondary' : 'success'"
            />
          </div>
        </div>
      </div>

      <!--! Stories -->
      <div class="div-stories d-flex gap-5 overflow-x-scroll overflow-y-visible">
        @for (storyCoverImage of user().stories; track $index) {

        <img class="img-story rounded-circle" src="/{{ storyCoverImage }}" alt="" />
        }
        <!--! Posts  -->
      </div>
      <app-posts [user]="user()"></app-posts>
    </div>
    }
  </section>

  <!--! Dialogs  -->

  <!--! Edit Dialog  -->
  <p-dialog header="Edit" [modal]="true" [(visible)]="visibleEditDialog">
    <form [formGroup]="form" class="h-auto overflow-visible" action="">
      <p-float-label variant="in" class="h-auto overflow-visible fs-6">
        <textarea
          pSize="large"
          [formControl]="form.controls.bio"
          class="h-auto"
          pTextarea
          type="bio"
          name="bio"
        ></textarea>
        <label for="bio" class="label-bio">Bio</label>
      </p-float-label>
      <div class="d-flex g-2 justify-content-around mt-5">
        <p-button
          severity="success"
          (onClick)="visibleEditDialog = false"
          (onClick)="onEditClick()"
          label="Edit"
        ></p-button>
        <p-button
          severity="secondary"
          (onClick)="visibleEditDialog = false"
          label="Cancel"
        ></p-button>
      </div>
    </form>
  </p-dialog>

  <!--! Sign up dialog -->

  <p-dialog header="Sign up" [modal]="true" [(visible)]="visibleRegisterDialog">
    <form [formGroup]="form" class="h-auto overflow-visible" action="">
      <p-float-label variant="in" class="h-auto overflow-visible fs-6 mb-4"
        ><input
          [formControl]="form.controls.username"
          class="h-auto"
          pInputText
          type="text"
          name="username"
        />
        <label for="username" class="label-username">Username</label>
      </p-float-label>
      <p-float-label variant="in" class="h-auto overflow-visible fs-6"
        ><input
          [formControl]="form.controls.password"
          class="h-auto"
          pInputText
          type="password"
          name="password"
        />
        <label for="password" class="label-password">Password</label>
      </p-float-label>
      <div class="d-flex g-2 justify-content-around mt-5">
        <p-button
          severity="success"
          (onClick)="visibleRegisterDialog = false"
          (onClick)="onFormSubmit()"
          label="Sign up!"
        ></p-button>
        <p-button
          severity="secondary"
          (onClick)="visibleRegisterDialog = false"
          label="Cancel"
        ></p-button>
      </div>
    </form>
  </p-dialog>
  <!--! Delete dialog  -->
  <p-dialog [size] [modal]="true" [(visible)]="visibleDeleteDialog" header="Are you sure?">
    <div class="d-flex gap-4">
      <p-button
        severity="danger"
        (onClick)="visibleDeleteDialog = false"
        (onClick)="onDeleteClick()"
        >Delete</p-button
      >
      <p-button severity="secondary" (onClick)="visibleDeleteDialog = false">Cancel</p-button>
    </div>
  </p-dialog>
</div>
